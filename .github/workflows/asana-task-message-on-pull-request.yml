name: Asana task message on pull request

on: [pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Add message
        run: |
          curl -X POST $TASK_URL \
          -H 'Content-Type: application/json' \
          -H 'Accept: application/json' \
          -H $AUTH_HEADER \
          -d $MESSAGE_DATA
        env:
          ASANA_AUTH_TOKEN: "0/227574f591313661629478091f094e34"
          TASK_ID: "1151485487957120"
          TASK_URL: "https://app.asana.com/api/1.0/tasks/${{TASK_ID}}/stories"
          AUTH_HEADER: "Authorization: Bearer ${{ASANA_AUTH_TOKEN}}"
          MESSAGE_DATA: '{"data":{"task":"$(cat TASK_ID)","text":"[Autogenerated message]\n Pull request link: ${{GITHUB_REPOSITORY}}/pull/"}}'